<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NEO Space Invaders v2.0</title>
    <style>
        body { background: #050505; color: #00ff00; text-align: center; font-family: 'Courier New', monospace; margin: 0; overflow: hidden; touch-action: none; }
        #game-container { position: relative; width: 100vw; height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        canvas { border: 2px solid #333; background: #000; box-shadow: 0 0 20px rgba(0,255,0,0.2); max-width: 95%; max-height: 70vh; }
        .ui { margin: 10px; font-size: 1.2em; text-transform: uppercase; letter-spacing: 2px; }
        .controls { font-size: 0.8em; color: #888; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div id="game-container">
        <div class="ui">SCORE: <span id="score">0</span></div>
        <div class="controls">TOCA PARA MOVER Y DISPARAR / FLECHAS + ESPACIO</div>
        <canvas id="g"></canvas>
    </div>
    <script>
        const c = document.getElementById('g');
        const ctx = c.getContext('2d');
        const scoreEl = document.getElementById('score');
        
        c.width = 600;
        c.height = 400;

        let score = 0;
        let gameActive = true;
        const p = { x: 275, y: 350, w: 40, h: 20 };
        const bullets = [];
        const enemies = [];
        let dir = 1;
        let speed = 1.5;

        function initEnemies() {
            for(let r=0; r<4; r++) {
                for(let col=0; col<8; col++) {
                    enemies.push({ x: col*60 + 50, y: r*40 + 50, w: 30, h: 20, alive: true });
                }
            }
        }

        function drawShip(x, y) {
            ctx.fillStyle = '#00ff00';
            ctx.fillRect(x + 15, y - 5, 10, 5);
            ctx.fillRect(x, y, 40, 20);
        }

        function drawEnemy(x, y) {
            ctx.fillStyle = '#ff3333';
            ctx.font = '20px Arial';
            ctx.fillText('ðŸ‘¾', x, y + 15);
        }

        function update() {
            if(!gameActive) return;

            let edge = false;
            enemies.forEach(e => {
                if(e.alive) {
                    e.x += speed * dir;
                    if(e.x > 560 || e.x < 10) edge = true;
                    if(e.y > 330) { gameActive = false; alert('LA COMPETENCIA HA GANADO. Â¡REINTENTA!'); location.reload(); }
                }
            });

            if(edge) {
                dir *= -1;
                enemies.forEach(e => e.y += 15);
                speed += 0.1;
            }

            bullets.forEach((b, i) => {
                b.y -= 7;
                if(b.y < 0) bullets.splice(i, 1);
                enemies.forEach(e => {
                    if(e.alive && b.x > e.x && b.x < e.x + e.w && b.y > e.y && b.y < e.y + e.h) {
                        e.alive = false;
                        bullets.splice(i, 1);
                        score += 100;
                        scoreEl.innerText = score;
                    }
                });
            });

            if(enemies.every(e => !e.alive)) {
                speed += 1;
                enemies.forEach(e => { e.alive = true; e.y -= 100; });
            }
        }

        function draw() {
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, c.width, c.height);
            
            drawShip(p.x, p.y);
            enemies.forEach(e => { if(e.alive) drawEnemy(e.x, e.y); });
            
            ctx.fillStyle = 'white';
            bullets.forEach(b => ctx.fillRect(b.x, b.y, 3, 10));

            if(!gameActive) {
                ctx.fillStyle = 'white';
                ctx.font = '40px Courier';
                ctx.fillText('GAME OVER', 180, 200);
            }
        }

        function loop() {
            update();
            draw();
            requestAnimationFrame(loop);
        }

        window.onkeydown = e => {
            if(e.key == 'ArrowLeft') p.x -= 20;
            if(e.key == 'ArrowRight') p.x += 20;
            if(e.key == ' ') bullets.push({x: p.x + 18, y: p.y});
        };

        c.onclick = e => {
            const rect = c.getBoundingClientRect();
            const scaleX = c.width / rect.width;
            p.x = (e.clientX - rect.left) * scaleX - 20;
            bullets.push({x: p.x + 18, y: p.y});
        };

        initEnemies();
        loop();
    </script>
</body>
</html>